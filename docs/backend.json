
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Daily Script app.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "authProvider": {
          "type": "string",
          "description": "The authentication provider used by the user (e.g., Google, Apple, anonymous)."
        },
        "email": {
          "type": "string",
          "description": "The user's email address, if provided.",
          "format": "email"
        },
        "creationDate": {
          "type": "string",
          "description": "The date and time the user account was created.",
          "format": "date-time"
        },
        "settingsId": {
          "type": "string",
          "description": "Reference to UserSettings. (Relationship: User 1:1 UserSettings)"
        }
      },
      "required": [
        "id",
        "authProvider",
        "creationDate",
        "settingsId"
      ]
    },
    "Verse": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Verse",
      "type": "object",
      "description": "Represents a Bible verse.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the verse."
        },
        "book": {
          "type": "string",
          "description": "The book of the Bible the verse is from."
        },
        "chapter": {
          "type": "number",
          "description": "The chapter number of the verse."
        },
        "verseNumber": {
          "type": "number",
          "description": "The verse number within the chapter."
        },
        "text": {
          "type": "string",
          "description": "The text of the Bible verse."
        },
        "version": {
          "type": "string",
          "description": "The Bible version of the verse (e.g., KJV, NIV, ESV)."
        }
      },
      "required": [
        "id",
        "book",
        "chapter",
        "verseNumber",
        "text",
        "version"
      ]
    },
    "FavoriteVerse": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FavoriteVerse",
      "type": "object",
      "description": "Represents a verse that a user has marked as a favorite.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the favorite verse entry."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N FavoriteVerse)"
        },
        "verseId": {
          "type": "string",
          "description": "Reference to Verse. (Relationship: Verse 1:N FavoriteVerse)"
        },
        "addedDate": {
          "type": "string",
          "description": "The date and time the verse was added to favorites.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "verseId",
        "addedDate"
      ]
    },
    "DailyVerse": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DailyVerse",
      "type": "object",
      "description": "Represents the verse of the day.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the daily verse entry."
        },
        "verseId": {
          "type": "string",
          "description": "Reference to Verse. (Relationship: Verse 1:1 DailyVerse)"
        },
        "date": {
          "type": "string",
          "description": "The date for which this verse is the daily verse.",
          "format": "date"
        }
      },
      "required": [
        "id",
        "verseId",
        "date"
      ]
    },
    "UserSettings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserSettings",
      "type": "object",
      "description": "Stores the user's preferences for the app.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user settings."
        },
        "bibleVersion": {
          "type": "string",
          "description": "The user's preferred Bible version (e.g., KJV, NIV, ESV)."
        },
        "darkModeEnabled": {
          "type": "boolean",
          "description": "Indicates whether dark mode is enabled."
        },
        "notificationsEnabled": {
          "type": "boolean",
          "description": "Indicates whether daily notifications are enabled."
        }
      },
      "required": [
        "id",
        "bibleVersion",
        "darkModeEnabled",
        "notificationsEnabled"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Uses path-based ownership for security.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/settings/{settingsId}",
        "definition": {
          "entityName": "UserSettings",
          "schema": {
            "$ref": "#/backend/entities/UserSettings"
          },
          "description": "Stores user-specific settings. Uses path-based ownership for security.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "settingsId",
              "description": "The unique identifier for the user settings document. It should match the userId."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/favoriteVerses/{favoriteVerseId}",
        "definition": {
          "entityName": "FavoriteVerse",
          "schema": {
            "$ref": "#/backend/entities/FavoriteVerse"
          },
          "description": "Stores user's favorite verses. Uses path-based ownership for security.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "favoriteVerseId",
              "description": "The unique identifier for the favorite verse entry."
            }
          ]
        }
      },
      {
        "path": "/verses/{verseId}",
        "definition": {
          "entityName": "Verse",
          "schema": {
            "$ref": "#/backend/entities/Verse"
          },
          "description": "Stores the Bible verses.",
          "params": [
            {
              "name": "verseId",
              "description": "The unique identifier for the verse."
            }
          ]
        }
      },
      {
        "path": "/dailyVerses/{date}",
        "definition": {
          "entityName": "DailyVerse",
          "schema": {
            "$ref": "#/backend/entities/DailyVerse"
          },
          "description": "Stores the verse of the day.",
          "params": [
            {
              "name": "date",
              "description": "The date for which this verse is the daily verse. Serves as the document ID."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the 'Daily Script' app, focusing on efficient data retrieval, user-specific data isolation, and scalable security rules. Authorization Independence is achieved through path-based ownership for user-specific data and denormalization where necessary. QAPs are supported via structural segregation ensuring secure list operations.\n\n*   **Users**: Each user has their own document in the `/users` collection, storing profile information and a reference to their settings. This isolates user data and simplifies security rules.\n*   **UserSettings**: Each user has a dedicated document in `/users/{userId}/settings` to store app preferences. Path-based ownership ensures only the user can access their settings.\n*   **FavoriteVerses**: Each user has a subcollection `/users/{userId}/favoriteVerses` to store their favorited verses. This isolates favorite verses per user and allows simple security rules based on the `userId`.\n*   **Verses**: The `/verses` collection stores all verses. There is also a subcollection `/dailyVerses/{date}` which stores the verse IDs. Daily verses use a date-based document ID to allow efficient querying. This design supports QAPs because verses are public and daily verses are queryable by date.\n\nThis structure prioritizes security, scalability, and ease of maintenance, aligning with the core design principles."
  }
}
